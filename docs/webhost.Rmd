---
title: "Applications of LANDFIRE in Vermont"
output: 
  flexdashboard::flex_dashboard:
    vertical_layout: scroll
    theme: flatly
    #standstone
    #flatly
    #readable
---
Background
=========================================

Maps
=========================================
Row
-------------------------------------
### Historical Biophysical Settings
```{r, echo=FALSE, out.width="100%"}
knitr::include_graphics("vermont_bps.jpg")
```
*** 

### Existing Vegitation Type
```{r, echo=FALSE, out.width="100%"}
knitr::include_graphics("vermont_evt_group.jpg")
```
*** 

### Estimating Old Growth
```{r, echo=FALSE, out.width="100%"}
knitr::include_graphics("potential_nh.jpg")
```
*** 

Row
-------------------------------------
### Commentary 1

### Commentary 2

### Commentary 3


Graphs
=========================================

-------------------------------------
```{r}
#library(readr)
#bps_sclass_practice <- #read_csv("C:/Users/ematula/Desktop/Vermont/thingy/bps_sclass.csv")
#selectInput('xcol', 'X Variable', names(bps_sclass_practice))
    
#selectInput('ycol', 'Y Variable', names(bps_sclass_practice),
#                selected=names(bps_sclass_practice)[[2]])
    

```

Column
-----------------------------------------
---
    
### Chart 1
    
```{r}
library(readr)
bps_sclass_practice <- read_csv("C:/Users/ematula/Desktop/Vermont/VTFdash/docs/bps_sclass.csv")
pacman::p_load(tidyverse, ggsci, ggtext, readr, dplyr, DT, crosstalk, plotly)
theme_set(theme_bw())
bps_sclass_practice <- read_csv("bps_sclass.csv")



# need to make longer
bps_sclass_practice <- bps_sclass_practice %>%
  pivot_longer(
    cols = c(`Reference`, `Current`), 
    names_to = "refCur", 
    values_to = "Percent"
  )

bps_sclass_practice$Sclass <- factor(bps_sclass_practice$Sclass, levels = c(
  "Early Development Hardwood", 
  "Early Development, Mid-Tolerant Hardwood", 
  "Mid Development 1, closed canopy", 
  "Mid Development 2, closed canopy", 
  "Late Development",
  "UE", 
  "UN", 
  "Agriculture",
  "Urban",
  "Barren or Sparse"))

#factor(bps_sclass_practice$Sclass, levels = rev(levels(bps_sclass_practice$Sclass)))


ggplot(bps_sclass_practice, aes(fill=factor(refCur), y=Percent, x=Sclass)) + 
  geom_col(width = 0.8, position = position_dodge()) +
  coord_flip() +
  #facet_grid(. ~BpS) +
  scale_x_discrete(limits = rev(levels(bps_sclass_practice$Sclass))) +
  labs(
    title = "Succession Classes past and present for Vermont",
    subtitle = "Laurentian-Acadian Northern Hardwoods Forest",
    caption = "Late-development, closed canopy, tallest succession class not present in this BpS. \nData from landfire.gov.",
    x = "",
    y = "Percent")+
  theme_minimal(base_size = 14)+
  theme(plot.caption = element_text(hjust = 0, face= "italic"), #Default is hjust=1
        plot.title.position = "plot", #NEW parameter. Apply for subtitle too.
        plot.caption.position =  "plot") +
  scale_fill_manual(values = c("#3d4740", "#32a852" ), # present (grey), historical (green)
                    name = " ", 
                    labels = c("Present",
                               "Past"))

```

### Chart 2

```{r}
nhheat <- read_csv("nh_heat.csv")

ggplot(nhheat,aes(x=evc, y=evh, fill = percent)) +
  geom_tile(color ='NA') +
  guides(fill=guide_legend(title="Percent of BpS \nper particular \ncombination")) +
  #scale_x_discrete(labels = function(x) paste0(x, "%")) +
  coord_cartesian(xlim=c(49,100), ylim=c(0, 22)) +
  labs(x="Canopy Cover %",
       y="Canopy Height (meters)",
       title="Canopy cover and height combinations",
       subtitle = "Northern Hardwood Forests of Vermont") +
  scale_fill_distiller(palette = "Greens", trans = "reverse") +
  theme_bw(base_size=14)+
 split(nhheat, cut(nhheat$evc, 2))
```
